<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>成为校方审核员</title>
</head>
<body>
    <h1>hello</h1>
    <form action="{% url 'public:createScholarUser' %}" method="post">
        <p><label>姓名：<input name="name" type="text"></label></p>
        <p><label>电话：<input name="tel" type="tel"></label></p>
        <input type="hidden" name='unionCode' value='{{ openid }}'>
        <p>选择单位</p>
        <select id='section' name="section">
            <option value="---">---</option>
        </select>
        <p>选择部门</p>
        <select name="clas" id="clas">
            <option value="---">---</option>
        </select>
        <button name="submit">提交</button>
    </form>
    <script type="text/javascript">
        if (window.XMLHttpRequest){
            console.log('xml')
            xmlhttp = new XMLHttpRequest();
        }else{
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }
        xmlhttp.open('GET','http://robbyzhang.cn/public/getDivisions/',false)
        xmlhttp.send()
        var divisions = JSON.parse(xmlhttp.response)['divisions']
        console.log(divisions)
        var section = document.getElementById('section')
        var clas = document.getElementById('clas')
        section.onchange = function(){
            console.log(section.value)
            for (var i = 1 ; i < clas ; i++){
                clas.removeChild(clas.options[i])
            }
            for(var j in divisions[section.value]){
                clas.options.add(new Option(j,j))
            }
        }
        for (var i in divisions){
            section.options.add(new Option(i,i))
        }
    </script>
</body>
</html>